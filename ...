\chapter{Localization}

\begin{recall}
    A subset $U \subseteq R$ is \emph{multiplicatively closed} if $1 \in U$ and for $u,v \in U$, $uv \in U$, 
\end{recall}

\begin{example}
    \begin{enumerate}
        \item $\{1,f,f^2,\cdots\} \subseteq R$ is multiplicatively closed for $f \in R$.
        \item $R^\times \subseteq R$ is multiplicatively closed.
        \item $R \setminus \ffp \subseteq R$ is multiplicatively closed for $\ffp \in \operatorname{Spec}(R)$.
        \item $1 + \ffa \subseteq R$ is multiplicatively closed for $\ffa \leq R$.
    \end{enumerate}
\end{example}

\begin{recall} \label{defOfMultiplicativelyClosedSet}
    For $U \subseteq R$ multiplicatively closed, $U^{-1}R = \{\frac{r}{u} \mid r \in R, u \in U\}$, where $\frac{r}{u} = \frac{r'}{u'}$ if and only if there exists $u'' \in U$ such that $u''(ru'-r'u) = 0$, i.e., $\frac{u''r}{u''u} = \frac{r'}{u'}$, formally, $\frac{r}{u}$ is the equivalence class under an equivalence relation. \par 
    $U^{-1}R$ is a nonzero commutative ring with identity. $\frac{r}{u} + \frac{s}{v} = \frac{rv+su}{uv}$ and $\frac{r}{u} \frac{s}{v} = \frac{rs}{uv}$ for $\frac{r}{u},\frac{s}{v} \in U^{-1}(R)$. \par 
    $0_{U^{-1}(R)} = \frac{0_R}{1_R} = \frac{0}{u}$ and $1_{U^{-1}R} = \frac{1_{R}}{1_{R}} = \frac{u}{u}$ for all $u \in U$. \par 
    $\frac{r}{u} = 0$ if and only if there exists $u'' \in U$ such that $u''r = 0$. \par 
    $\psi: R \to U^{-1}R$ given by $\psi(r) = \frac{r}{1}$ is a well-defined ring homomorphism.
\end{recall}

\begin{notation}
    \begin{enumerate}
        \item If $U = \{1,f,f^2,\cdots\}$, write $U^{-1}R = R_f$.
        \item If $U = R \setminus \ffp$ for some $\ffp \in \operatorname{Spec}(R)$, write $U^{-1}R = R_\ffp$.
        \item If $U \subseteq R$ is multiplicatively closed, write $U^{-1}R = R_U = R[U^{-1}]$.
    \end{enumerate}
\end{notation}

\noindent Let $U \subseteq R$ multiplicatively closed.

\begin{customrecall}{\ref{defOfMultiplicativelyClosedSet}+$\epsilon$}
    For $u \in U$, $\psi(u) \in (U^{-1}R)^{\times}$ since $\frac{1}{u} = (\frac{u}{1})^{-1} = (\psi(u))^{-1}$.
\end{customrecall}

\begin{proposition}[UMP for $\psi$]
    Let $\varphi: R \to S$ be a ring homomorphism such that $\varphi(U) \subseteq S^{\times}$. Then there exists a unique ring homomorphism $\Phi:U^{-1}R \to S$ such that $\Phi \circ \psi = \varphi$. In fact, $\Phi(\frac{r}{u}) = \varphi(r)\varphi(u)^{-1}$ for $\frac{r}{u} \in U^{-1}R$.
    \begin{center}
        \begin{tikzcd}
            R \rar["\psi"] \drar["\varphi"'] & U^{-1}R \dar[dashed,"\ex !\ \Phi"] \\
            & S
        \end{tikzcd}
    \end{center}
\end{proposition}

\begin{proof}
    Let $\frac{r}{u} = \frac{r'}{u'}$. Then there exists $u'' \in U$ such that $u''(ru'-r'u) = 0$. Since $\varphi$ is a ring homomorphism, we have $\varphi(u'')(\varphi(r)\varphi(u') - \varphi(r')\varphi(u)) = 0$. Also, since $\varphi(u'') \in S^{\times}$, we have $\varphi(r)\varphi(u') = \varphi(r')\varphi(u)$, i.e., $\varphi(r)\varphi(u)^{-1} = \varphi(r')\varphi(u')^{-1}$ since $\varphi(u), \varphi(u') \in S^{\times}$. So $\phi$ is well-defined. \par
    Since $\Phi(\frac{r}{u} + \frac{s}{v}) = \Phi(\frac{rv+su}{uv}) = \varphi(rv+su)\varphi(uv)^{-1} = (\varphi(r)\varphi(v) + \varphi(s)\varphi(u))) \varphi(u)^{-1}\varphi(v)^{-1} = \varphi(r)\varphi(u)^{-1} + \varphi(s)\varphi(v)^{-1} = \Phi(\frac{r}{u}) + \Phi(\frac{s}{v})$ and similarly, $\Phi(\frac{r}{u} \cdot \frac{s}{v}) = \Phi(\frac{r}{u})\Phi(\frac{s}{v})$ for $\frac{r}{u},\frac{s}{v} \in U^{-1}R$, we have $\Phi$ is ring homomorphism. \par 
    Suppose there is another ring homomorphism $\Lambda: U^{-1}R \to S$ such that $\Lambda \circ \psi = \varphi$.
    \begin{center}
        \begin{tikzcd}
            R \rar["\psi"] \drar["\varphi"'] & U^{-1}R \dar["\Lambda"] \\
            & S
        \end{tikzcd}
    \end{center}
    Then $\varphi(r) = \Lambda (\psi(r)) = \Lambda (\frac{r}{1})$ for $r \in R$. So $\Lambda(\frac{r}{u}) = \Lambda(\frac{r}{1} \frac{1}{u}) = \Lambda(\frac{r}{1}) \Lambda(\frac{u}{1})^{-1} = \varphi(r) \varphi(u)^{-1} = \Phi(\frac{r}{u})$ for $\frac{r}{u} \in U^{-1}R$. Thus, $\Lambda = \Phi$, i.e., such $\Phi$ is unique.
\end{proof}

\begin{proposition}
    Let $\varphi: R \to S$ be a ring homomorphism.
    \begin{enumerate}
        \item $\varphi(U) \subseteq S$ is multiplicatively closed and $\varphi(U)^{-1}S =: U^{-1}S$.
        \item There is a ring homomorphism: $U^{-1}\varphi: U^{-1}R \to U^{-1}S$ given by $U^{-1}\varphi(r/u) = \varphi(r)/\varphi(u)$.
            \begin{center}
                \begin{tikzpicture}[node distance = 1.5cm, auto]
                    \node (R) {$R$};
                    \node (UR)[right of=R] {$U^{-1}R$};
                    \node (S)[below of=R] {$S$};
                    \node (US)[below of=UR] {$U^{-1}S$};
                    \node (r)[node distance=0.8cm, left of=R, above of=R] {$r$};
                    \node (ur)[node distance=0.8cm, right of=UR, above of=UR] {$\frac{r}{1}$};
                    \node (s)[node distance=0.8cm, left of=S, below of=S] {$\varphi(r)$};
                    \node (us)[node distance=0.8cm, right of=US, below of=US] {$\frac{\varphi(r)}{1} = \frac{\varphi(r)}{\varphi(1)}$};
                    \draw[->] (R) to node {$\psi$} (UR);
                    \draw[->] (R) to node [swap]{$\varphi$} (S);
                    \draw[->] (UR) to node [swap] {$U^{-1}\varphi$} (US);
                    \draw[->] (S) to node [swap]{$\rho$} (US);
                    \draw[|->] (r) to node {} (ur);
                    \draw[|->] (r) to node {} (s);
                    \draw[|->] (s) to node {} (us);
                    \draw[|->] (ur) to node {} (us);
                \end{tikzpicture}
            \end{center}
        \item If $\varphi$ is onto, $U^{-1}\varphi$ is onto.
        \item If $\varphi$ is 1-1, $U^{-1}\varphi$ is 1-1.
        \item If $\alpha: S \to T$ is a ring homomorphism, then $U^{-1}(\alpha \circ \varphi) = (\varphi(U)^{-1}\alpha) \circ (U^{-1}\varphi)$. 
        \begin{center}
            \begin{tikzpicture}[node distance = 1.5cm, auto]
                \node (S) {$S$};
                \node (US)[node distance=3cm, right of=S] {$U^{-1}S$};
                \node (R)[above of=S, left of=S] {$R$};
                \node (T)[below of=S, left of=S] {$T$};
                \node (UR)[above of=S, right of=S] {$U^{-1}R$};
                \node (UT)[below of=S, right of=S] {$\varphi(U)^{-1}T$};

                \node [node distance=2cm, right of=UT] {$:=\alpha (\varphi(U))^{-1}T$};
                \node [node distance=1.45cm, right of=US] {$:=\varphi(U)^{-1}S$};
                \draw[->] (R) to node {$\varphi$} (S);
                \draw[->] (R) to node [swap]{$\alpha \circ \varphi$} (T);
                \draw[->] (S) to node {$\alpha$} (T);
                \draw[->] (R) to node {} (UR);
                \draw[->] (T) to node {} (UT);
                \draw[->] (UR) to node {$U^{-1}\varphi$} (US);
                \draw[->] (US) to node {} (UT);
                \draw[->,name path=line 1] (S) to node {} (US);
                \path[name path=line 2] (UR) to node {} (UT);
                % find intersection of first and second line
                \path [name intersections={of = line 1 and line 2}];
                \coordinate (P)  at (intersection-1);

                % path a circle around this intersection for the arc
                \path[name path=circle] (P) circle(1.mm);
                % find intersections of second line and circle
                \path [name intersections={of = circle and line 2}];
                \coordinate (I1)  at (intersection-1);
                \coordinate (I2)  at (intersection-2);
                % draw normal line segments
                \draw (UR) -- (I1);
                \draw[->] (I2) -- (UT);
                % draw arc at intersection
                \tkzDrawArc[color=black](P,I1)(I2);
            \end{tikzpicture}
        \end{center}
    \end{enumerate}
\end{proposition}

\begin{proof}
    \begin{enumerate}
        \item [(b)] 
            Let $\frac{r}{u} = \frac{r'}{u'} \in U^{-1}R$. Then there exists $u'' \in U$ such that $u''(ur'-u'r) = 0$. So there exists $\varphi(u'') \in \varphi(U)$ such that $\varphi(u'')(\varphi(r)\varphi(u') - \varphi(r')\varphi(u)) = 0$. Hence $\frac{\varphi(r)}{\varphi(u)} = \frac{\varphi(r')}{\varphi(u')} \in U^{-1}S$ and so $U^{-1}\varphi$ is well-defined. \par 
            Since $U^{-1}\varphi(\frac{r}{u} + \frac{s}{v}) = U^{-1}\varphi(\frac{rv+su}{uv}) = \frac{\varphi(rv+su)}{\varphi(uv)} = \frac{\varphi(r)\varphi(v)+\varphi(s)\varphi(u)}{\varphi(u)\varphi(v)} = \frac{\varphi(r)}{\varphi(u)}+\frac{\varphi(s)}{\varphi(v)} = U^{-1}\varphi(\frac{r}{u})+U^{-1}(\varphi)(\frac{s}{v})$ and $U^{-1}(\varphi)(\frac{r}{u} \cdot\frac{s}{v}) = U^{-1}\varphi(\frac{rs}{uv}) = \frac{\varphi(rs)}{\varphi(uv)} =\frac{\varphi(r)}{\varphi(u)} \cdot \frac{\varphi(s)}{\varphi(v)} = U^{-1}\varphi(\frac{r}{u})U^{-1}\varphi(\frac{s}{v})$ for $\frac{r}{u},\frac{s}{v} \in U^{-1}R$, we have $U^{-1}\varphi$ is a ring homomorphism. 
        \item [(c)]
            Assume $\varphi$ is onto. Let $\frac{s}{\varphi(u)} \in U^{-1}S$. Then there exists $r \in R$ such that $\varphi(r) = s$. Since $U^{-1}\varphi(\frac{r}{u}) = \frac{\varphi(r)}{\varphi(u)} = \frac{s}{\varphi(u)}$, we have $U^{-1}\varphi$ is onto.
        \item[(d)] Assume $\varphi$ is 1-1. Then $\frac{r}{u} \in \ker(U^{-1}\varphi)$ if and only if $0 = U^{-1}\varphi(\frac{r}{u}) = \frac{\varphi(r)}{\varphi(u)}$ if and only if there exists $u'' \in U$ such that $\varphi(u'')\varphi(r) = 0 = \varphi(u''r)$ if and only if there exists $u'' \in U$ such that $u''r = 0$ if and only if $\frac{r}{u} = 0$ in $U^{-1}R$.
        \item[(e)]
            Since $\varphi:R \to S$ and $\alpha: S \to T$ are ring homomorphisms, $\alpha \circ \varphi$ is a ring homomorphism. Since $\alpha(\varphi(U)) \subseteq T$ is multiplicatively closed by (a), $\varphi(U)^{-1}\alpha$ is well-defined. 
        \begin{center}
            \begin{tikzpicture}[auto]
                \node (UR) {$U^{-1}R$};
                \node (UT)[node distance=3cm, below of=UR] {$(\alpha \circ \varphi)(U)^{-1}T$};
                \node (XXX)[node distance=1.5cm, below of=UR] {};
                \node (US)[node distance=5cm, right of=XXX] {$\varphi(U)^{-1}S$};
                \node (UT2)[node distance=2.5cm, right of=UT] {$\alpha (\varphi(U))^{-1}T$};


                \draw[->] (UR) to node {$U^{-1}(\alpha \circ \varphi)$} (UT);
                \draw[->] (UR) to node {$U^{-1}\varphi$} (US);
                \draw[->] (US) to node [swap]{$\varphi(U)^{-1}\alpha$} (UT2);
                \node (ur) [node distance=0.8cm, above of=UR,left of=UR]{$\frac{r}{u}$};
                \node (ut) [node distance=1cm, below of=UT]{$\frac{(\alpha \circ \varphi)(r)}{(\alpha \circ \varphi)(u)}$};
                \node (ut2) [node distance=1cm, below of=UT2]{$\frac{\alpha(\varphi(r))}{\alpha(\varphi(u))}$};
                \node (us) [node distance=1.5cm, right of=US]{$\frac{\varphi(r)}{\varphi(u)}$};
                \draw[|->, bend left] (ur) to node {} (us);
                \draw[|->] (us) to node [swap]{} (ut2);
                \draw[|->, bend right=60] (ur) to node {} (ut); 
                \node (equal) [node distance=1.3cm, right of=ut] {$=$};
            \end{tikzpicture}
        \end{center} 
    \qedhere
    \end{enumerate}
\end{proof}

\begin{proposition}
    $\im(U^{-1}\varphi) \cong U^{-1} \im(\varphi)$.
\end{proposition}

\noindent Let $\ffa,\ffb \leq R$.

\begin{definition}
    Define relation ``$\sim$'' on $U \times \ffa$: $(u,a) \sim (u',a')$ if and only if there exists $u'' \in U$ such that $u''(u'a - ua') = 0$.
\end{definition}

\begin{fact}
    This is an equivalence relation.
\end{fact}

\begin{notation}
    $U^{-1}\ffa = \{\text{equivalence classes from $U \times \ffa$ under $\sim$}\}$ and $a/u$ or $\frac{a}{u}$ with $a \in \ffa$ and $u \in U$ are its elements.
\end{notation}

\begin{proposition}
    \begin{enumerate}
        \item The map $i: U^{-1}\ffa \to U^{-1}R$ given by $i(a/u) = a/u$ is well-defined and 1-1. Identify $U^{-1}\ffa$ with $\im(i) \subseteq U^{-1}R$. So write $U^{-1}\ffa \subseteq U^{-1}R$. \par 
            \textbf{Warning.} $\frac{r}{u} \in U^{-1}R$ such that $r/u \in U^{-1}\ffa$ may have $r \not \in \ffa$.
        \item 
        \item 
        \item 
        \item 
    \end{enumerate}
\end{proposition}

\begin{proof}
    \begin{enumerate}
        \item 
        \item 
        \item 
        \item 
    \end{enumerate}
\end{proof}

\begin{proposition}
    \begin{enumerate}
        \item $U^{-1}(\ffa + \ffb) = (U^{-1}\ffa) + (U^{-1}\ffb)$.
        \item $U^{-1}(\ffa \cap \ffb) = (U^{-1}\ffa) \cap (U^{-1}\ffb)$.
        \item $U^{-1}(\ffa \ffb) = (U^{-1}\ffa) (U^{-1}\ffb)$.
        \item $\operatorname{rad}(U^{-1}\ffa) = U^{-1} \operatorname{rad}(\ffa)$.
        \item $\operatorname{Nil}(U^{-1}R) = U^{-1}\operatorname{Nil}(R)$.
        \item $(U^{-1}\ffb:U^{-1}\ffa) = U^{-1}(\ffb:\ffa)$ if $\ffa$ is finitely generated.
    \end{enumerate}
\end{proposition}

\begin{proof}
    \begin{enumerate}
        \item $U^{-1}(\ffa+\ffb) = (\ffa+\ffb)U^{-1}R = (\ffa U^{-1}R) + (\ffb U^{-1}R) = (U^{-1}\ffa) + (U^{-1}\ffb)$.
        \item $U^{-1}(\ffa \cap \ffb) \subseteq$
        \item 
        \item 
        \item 
        \item 
    \end{enumerate}
\end{proof}

\begin{proposition}
    Let $\psi: R \to U^{-1}R$.
    \begin{enumerate}
        \item For any $I \leq U^{-1}R$, there exists $\ffa \leq R$ such that $I = U^{-1}\ffa$. (See proof of theorem 2.28 with $\ffa = \psi^{-1}(I)$).
        \item If $\ffa \leq R$, then $\psi^{-1}(U^{-1}\ffa) =\{r \in R \mid \ex v \in U \text{ s.t. }v r \leq R\} = \bigcup_{v \in U} (\ffa:v)$.
        \item $U^{-1}\ffa$.
    \end{enumerate}
\end{proposition}

\begin{proposition}
\end{proposition}

\begin{corollary}
    Let $\ffp \in \operatorname{Spec}(R)$. $R/\ffp$ is an integral domain with $Q(R/\ffp)$ the field of fraction, $R_\ffp$ is local with maximal ideal $\ffp_\ffp$ and $R_\ffp/\ffp_\ffp$ is a field. Then $Q(R/\ffp) \xleftarrow \cong R_\ffp/\ffp_\ffp$ given by $\overbar r / \overbar u \mapsfrom \overbar {r/u}$.
\end{corollary}

\begin{proof}
    Special case of previous result with $U = R \setminus \ffp$. Let $\tau: R \to R/\ffp$ be the natural projection. Then $R/\ffp = U^{-1}R/U^{-1}\ffp \cong U^{-1}(R/\ffp) = \tau(u)^{-1}(R/\ffp) = Q(R/\ffp)$.
\end{proof}

\begin{corollary}
    $\ffm \in \operatorname{m-Spec}(R)$. $R_\ffm/\ffm_\ffm \cong R/\ffm$.
\end{corollary}

\begin{proof}

\end{proof}

\begin{example*}
    \begin{enumerate}
        \item 
        \item 
    \end{enumerate}
\end{example*}

Q: If $\ffp \in \operatorname{Spec}(R)$ such that $\ffp \cap U = \emptyset$, then $U^{-1}\ffp \in \operatorname{Spec}(U^{-1}(R))$. What does $(U^{-1}R)_{U^{-1}\ffp}$ look like?

\begin{recall*}
    $\frac{r}{u} \in U^{-1}R$: $\frac{r}{u} \in U^{-1}\ffa$ if and only if there exists $v \in U$ such that $vr \in \ffa$.
\end{recall*}

\begin{lemma}
    $\ffp \in \operatorname{Spec}(R)$ and $\frac{r}{u} \in U^{-1}\ffp$ if and only if $r \in \ffp$ and $U \cap \ffp = \emptyset$.
\end{lemma}

\begin{proof}

\end{proof}

\begin{proposition}
    Let $\ffp \in \operatorname{Spec}(R)$ such that $\ffp \cap U = \emptyset$, so $U^{-1}\ffp \in \operatorname{Spec}(U^{-1}R)$. Then 
    \begin{align*}
        (U^{-1}R)_{U^{-1}\ffp} &\xrightarrow \cong R_\ffp \\
        \frac{r/1}{s/1} &\mapsfrom r/s \ s \in R \setminus \ffp \\
        r &\mapsto r/1
    \end{align*}
\end{proposition}

\begin{proof}
    graph..... \\
    $\frac{x}{1}$ is a allowable denominator. So $\frac{1/1}{x/1} \in (U^{-1}R)_{U^{-1}\ffp}$. So $\frac{x/1}{1/1}$ is a unit in $(U^{-1}R)_{U^{-1}\ffp}$ with $(\frac{x/1}{1/1})^{-1} = \frac{1/1}{x/1}$. $\varphi(r/s) = \beta(r)/\beta(s) = \frac{r/1}{s/1}$ \par 
    1-1. \par 
    onto. \par 
\end{proof}

\begin{corollary}
    If $\ffp,\ffq \in \operatorname{Spec}(R)$ with $\ffp \subseteq \ffq$, then $\ffp_\ffq \in \operatorname{Spec}(R_\ffp)$ and $(R_\ffq)_{\ffp_\ffq} \xleftarrow \cong R_\ffp$ given by $\frac{r/1}{s/1} \mapsfrom r/s$.
\end{corollary}

\begin{proof}
    $U = R \setminus \ffp$.
\end{proof}

\begin{example}
    \begin{enumerate}
        \item 
        \item 
    \end{enumerate}
\end{example}

\begin{proposition}
    Let $R \neq 0$. Then $\operatorname{NZD}(R) \subseteq R$ is multiplicatively closed. Moreover, it is \emph{saturated}. If $r,s \in R$ such that $rs \in \operatorname{NZD}(R)$, then $r,s \in \operatorname{NZD}(R)$.
\end{proposition}

\begin{proof}
    Since $R \neq 0$, $1 \in \operatorname{NZD}$. Let $r,s \in \operatorname{NZD}(R)$. Assume $(rs)t=0$. Then $0 = (rs)t = r(st)$. Since $r \in \operatorname{NZD}(R)$, $st = 0$. Also, since $s \in \operatorname{NZD}(R)$, $t = 0$. So $rs \in \operatorname{NZD}(R)$. \par 
    Let $x,y \in R$ such that $xy \in \operatorname{NZD}(R)$. By symmetry, need to show $x \in \operatorname{NZD}(R)$. Assume $xz = 0$. Then $(xy)z = y(xz) = 0$. Since $xy \in \operatorname{NZD}(R)$, $z = 0$.
\end{proof}

\begin{definition}
    The \emph{total ring of fractions of} $R$ (or \emph{total quotient ring of }$R$) is $Q(R) = \operatorname{NZD}(R)^{-1}R$.
\end{definition}

\begin{example}
    \begin{enumerate}
        \item If $R$ is an integral domain, then $\operatorname{NZD}(R) = R \setminus \{0\}$ and $\operatorname{NZD}(R)^{-1}(R) = (R \setminus 0)^{-1}(R) = Q(R)$.
        \item $R = \frac{k[X,Y,Z,W]}{\langle XY,YZ,ZW,XW \rangle}$. $\langle XY,YZ,ZW,XW \rangle = \langle X,Z \rangle \cap \langle Y,W \rangle$. $\operatorname{ZD}(R) = $.
    \end{enumerate}
\end{example}

\begin{proposition}
\end{proposition}


Q: Let $\varphi: R \to S$ be a ring homomorphism, $\ffp \in \operatorname{Spec}(R)$ and $\varphi^*: \operatorname{Spec}(S) \to \operatorname{Spec}(R)$.
\begin{enumerate}
    \item When is $\ffp \in \im(\varphi^*)$?, i.e., when does there exist $\ffq \in \operatorname{Spec}(R)$ such that $\ffp  = \varphi^{-1}(\ffq)$.
    \item What does $(\varphi^*)^{-1}(\ffp) = \{\ffq \in \operatorname{Spec}(S) \mid \varphi^*(\ffq) = \ffp\}$ look like? In general, $f: Y \to X$ is a (continuous) function and $x \in X$, then $f^{-1}(x) = \{y \in Y \mid f(y) = x\} = \text{fibre over $x$ w.r.t. $f$}$.
\end{enumerate}

\begin{construction}
    graph. has a well-defined map at the bottom in the middle.
    graph.
\end{construction}

\begin{theorem}
    The following are equivalent.
    \begin{enumerate}
        \item $\ffp \in \im(\varphi^*)$, i.e., $(\varphi^*)^{-1}(\ffp) \neq \emptyset$.
        \item $\ffp = \varphi^{-1}(\ffp S)$, where $\ffp S$ is not necessarily prime.
        \item $\varphi \cdot U^{-1}(S) \neq U^{-1}(S)$, i.e., $\llF(\ffp) = U^{-1}S/\ffp U^{-1}(S) \neq \emptyset$.
    \end{enumerate}
    Moreover, the map $\theta: \operatorname{Spec}(\llF(\ffp)) \to (\varphi^*)^{-1}(\ffp)$ given by $\theta(Q) = \varphi^{-1}(\pi^{-1}(Q)$ is a well-defined bijection.
\end{theorem}

\begin{proof}
    ``(i)$\Rightarrow$(ii)''. Assume there exists $\ffq \in \operatorname{Spec}(S)$ such that $\ffp = \varphi^*(\ffq) = \varphi^{-1}(\ffq) = \varphi^{-1}(\varphi^{-1}(\ffq)S) = \varphi^{-1}(\ffp S)$. \par 
    ``(ii)$\Rightarrow$(iii)''. Assume $\varphi = \varphi^{-1}(\ffp S)$. Then $\ffp \cdot U^{-1}(S) = \ffp S \cdot U^{-1}(S) = \ffp S \cdot \varphi(U)^{-1}S$. Recall $\ffa \leq S$: $\ffa \cap \varphi(U)^{-1}S = \varphi(U)^{-1}S$ if and only if $\ffa \cap \varphi(U) \neq \emptyset$. To show $\ffp S \cdot \varphi(U)^{-1}S \neq \varphi(U)^{-1}S$, we need to show $\ffp S \cap \varphi(U) = \emptyset$. Suppose $\varphi(u) \in \ffp S \cap \varphi(U)$. Then $u \in \smallunderbrace{\varphi^{-1}(\ffp S)}_{\ffp} \cap \smallunderbrace U_{R \setminus \ffp} = \emptyset$. \par 
    ``(iii)$\Rightarrow$(i) and well-definedness of $\theta$''.... \par 
    $\theta$ is 1-1? $\theta = \text{restriction of $\varphi^* \circ \pi^{*}$}$. \par 
    $\theta$ is onto?
\end{proof}

\begin{proposition}
    If $\varphi:R \to S$ is a ring homomorphism and $(R,\ffm)$ is local, then $\llF(\ffm) \cong S/\ffm S$.
\end{proposition}

\begin{proof}
    $U = R \setminus \ffm \subseteq R^\times$. $U^{-1}(-) \cong -$, e.g., $U^{-1}S/\ffm U^{-1}S \cong S/\ffm S$.
\end{proof}

\begin{definition}
    \begin{enumerate}
        \item If $(R,\ffm)$ is local, then $\llF(\ffm) \cong S/\ffm S$ is the \emph{closed fibre} of $\varphi$ (fibre over unique closed point of $\operatorname{Spec}(R)$).
        \item 
            If $R$ is an integral domain, then $\llF(0)$ is the \emph{generic fibre} of $\varphi$ (fibre over the generic point of $R$).
    \end{enumerate}
\end{definition}

\begin{example}
    \begin{enumerate}
        \item $\varphi: R \xhookrightarrow \subseteq R[X_1,\cdots,R_d]$
            \begin{enumerate}
                \item $(R,\ffm)$ is local. $\llF(\ffm) \cong $.
                \item $\ffp \in \operatorname{Spec}(R)$.
            \end{enumerate}
        \item 
            \begin{enumerate}
                \item
            \end{enumerate}
        \item
            \begin{enumerate}
                \item 
                \item 
            \end{enumerate}
    \end{enumerate}
\end{example}

